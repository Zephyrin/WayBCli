<div
     class="table-responsive-sm table-responsive-md table-responsive-lg table-responsive-xl">
  <div *ngIf="service.errors.hasFatalError"
       class="alert alert-danger">
    <div [innerHTML]="service.errors.fatalError"></div>
  </div>
  <div *ngIf="service.errors.hasMessage"
       class="alert alert-warning">
    <div>{{service.errors.message}}</div>
  </div>
  <div *ngIf="service.errors.hasErrors['validate']">
    <div *ngFor="let child of service.errors.errors['name'].errors">
      {{child}}
    </div>
  </div>
  <fieldset [disabled]="service.loading">
    <nav
         class="navbar navbar-expand-md navbar-light bg-light d-block d-sm-none">
      <div class="navbar-collapse collapse"
           id="filterBrandNavDropdown">
        <app-brand-filter></app-brand-filter>
      </div>
    </nav>
    <div class="d-flex justify-content-between align-items-center">
      <button class="btn btn-light"
              *ngIf="!isValidator"
              (click)="brandModal.open()">
        <mat-icon>add</mat-icon>
      </button>
      <app-brand-filter class="d-none d-sm-block"></app-brand-filter>
      <app-pagination [pagination]="service"></app-pagination>
    </div>
    <table class="table">
      <thead>
        <tr>
          <th scope="col"
              class="col-md-5 pointer"
              (click)="service.sortByOrOrient(sortByEnum.name)">
            <div class="d-flex">Name
              <div *ngIf="service.sortBy === sortByEnum.name">
                <mat-icon *ngIf="service.sort === sortEnum.asc">arrow_drop_down
                </mat-icon>
                <mat-icon *ngIf="service.sort === sortEnum.desc">arrow_drop_up
                </mat-icon>
              </div>
            </div>
          </th>
          <th scope="col"
              class="col-md-5 pointer"
              (click)="service.sortByOrOrient(sortByEnum.uri)">
            <div class="d-flex">URL
              <div *ngIf="service.sortBy === sortByEnum.uri">
                <mat-icon *ngIf="service.sort === sortEnum.asc">arrow_drop_down
                </mat-icon>
                <mat-icon *ngIf="service.sort === sortEnum.desc">arrow_drop_up
                </mat-icon>
              </div>
            </div>
          </th>
          <th scope="col"
              class="col-md-1 pointer"
              *ngIf="isValidator"
              (click)="service.sortByOrOrient(sortByEnum.askValidate)">
            <div class="d-flex justify-content-center">Ask validation
              <div *ngIf="service.sortBy === sortByEnum.askValidate">
                <mat-icon *ngIf="service.sort === sortEnum.asc">arrow_drop_down
                </mat-icon>
                <mat-icon *ngIf="service.sort === sortEnum.desc">arrow_drop_up
                </mat-icon>
              </div>
            </div>
          </th>
          <th scope="col"
              class="col-md-1 pointer"
              (click)="service.sortByOrOrient(isValidator ? sortByEnum.validate : sortByEnum.askValidate)">
            <div class="d-flex justify-content-center">Action
              <div *ngIf="!isValidator && service.sortBy === sortByEnum.askValidate">
                <mat-icon *ngIf="service.sort === sortEnum.asc">arrow_drop_down
                </mat-icon>
                <mat-icon *ngIf="service.sort === sortEnum.desc">arrow_drop_up
                </mat-icon>
              </div>
              <div *ngIf="isValidator && service.sortBy === sortByEnum.validate">
                <mat-icon *ngIf="service.sort === sortEnum.asc">arrow_drop_down
                </mat-icon>
                <mat-icon *ngIf="service.sort === sortEnum.desc">arrow_drop_up
                </mat-icon>
              </div>
            </div>
          </th>
        </tr>
      </thead>
      <tr *ngFor="let brand of service.brands"
          (click)="service.setSelected(brand)"
          (dblclick)="dblClick(brand)"
          [class.active]="brand == service.selected && service.canEditOrDelete(brand)"
          [class.pointer]="service.canEditOrDelete(brand)">
        <td><img *ngIf="brand.logo && brand.logo.hasUrl()"
               [src]="brand.logo.url()"
               [alt]="brand.logo.description"
               class="rounded img-thumbnail" /><b>{{brand.name}}</b>
        </td>
        <td>
          <a [attr.href]="service.returnUrl(brand.uri)"
             target="_blank"
             rel="noopener noreferrer">{{brand.uri}}</a>
        </td>
        <td *ngIf="isValidator">
          <app-switch [value]="brand.askValidate"
                      [disabled]="true"
                      >
          </app-switch>
        </td>
        <td>
          <div class="col">
            <div>
              <div class="btn-group"
                   role="group"
                   aria-label="Tools"
                   *ngIf="service.canEditOrDelete(brand)">
                <button type="button"
                        class="btn btn-light"
                        data-toggle="modal"
                        data-target="#addEquipmentModal"
                        (click)="brandModal.open(brand)">
                  <mat-icon>update</mat-icon>
                </button>
                <button type="button"
                        class="btn btn-light"
                        (click)="brandModal.onDelete(brand)">
                  <mat-icon>delete</mat-icon>
                </button>
                <app-switch [value]="brand.askValidate"
                            [disabled]="service.loading"
                            (isChecked)="service.updateAskValidate(brand)"
                            *ngIf="!isValidator">
                </app-switch>
                <app-switch [value]="brand.validate"
                            [disabled]="service.loading"
                            (isChecked)="service.updateValidate(brand)"
                            *ngIf="isValidator"></app-switch>
                <span *ngIf="service.loading && service.selected === brand"
                      class="spinner-border spinner-border-sm mr-1"></span>
              </div>
            </div>
          </div>
        </td>
      </tr>
    </table>
    <app-pagination [pagination]="service"></app-pagination>
  </fieldset>
  <div *ngIf="service.errors.hasFatalError"
       class="alert alert-danger">
    <div [innerHTML]="service.errors.fatalError"></div>
  </div>
  <div *ngIf="service.errors.hasMessage"
       class="alert alert-warning">
    <div>{{service.errors.message}}</div>
  </div>
  <div *ngIf="service.errors.hasErrors['validate']">
    <div *ngFor="let child of service.errors.errors['name'].errors">
      {{child}}
    </div>
  </div>
</div>
<app-brand-update #brandModal></app-brand-update>
